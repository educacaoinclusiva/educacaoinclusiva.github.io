(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{"HJ/b":function(t,e,o){"use strict";o.r(e),o.d(e,"Tab2PageModule",(function(){return y}));var i=o("TEn/"),n=o("tyNb"),r=o("ofXK"),a=o("3Pt+"),s=o("mrSG"),c=o("gcOT"),l=o("fXoL");const{Camera:h,Filesystem:b,Storage:d}=c.e;let u=(()=>{class t{constructor(t){this.photos=[],this.PHOTO_STORAGE="photos",this.convertBlobToBase64=t=>new Promise((e,o)=>{const i=new FileReader;i.onerror=o,i.onload=()=>{e(i.result)},i.readAsDataURL(t)}),this.platform=t}loadSaved(){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield d.get({key:this.PHOTO_STORAGE});if(this.photos=JSON.parse(t.value)||[],!this.platform.is("hybrid"))for(let e of this.photos){const t=yield b.readFile({path:e.filepath,directory:c.d.Data});e.webviewPath=`data:image/jpeg;base64,${t.data}`}}))}addNewToGallery(){return Object(s.a)(this,void 0,void 0,(function*(){const t=yield h.getPhoto({resultType:c.a.Uri,source:c.b.Camera,quality:100}),e=yield this.savePicture(t);this.photos.unshift(e),d.set({key:this.PHOTO_STORAGE,value:JSON.stringify(this.photos)})}))}savePicture(t){return Object(s.a)(this,void 0,void 0,(function*(){const e=yield this.readAsBase64(t),o=(new Date).getTime()+".jpeg",i=yield b.writeFile({path:o,data:e,directory:c.d.Data});return this.platform.is("hybrid")?{filepath:i.uri,webviewPath:c.c.convertFileSrc(i.uri)}:{filepath:o,webviewPath:t.webPath}}))}readAsBase64(t){return Object(s.a)(this,void 0,void 0,(function*(){if(this.platform.is("hybrid"))return(yield b.readFile({path:t.path})).data;{const e=yield fetch(t.webPath),o=yield e.blob();return yield this.convertBlobToBase64(o)}}))}deletePicture(t,e){return Object(s.a)(this,void 0,void 0,(function*(){this.photos.splice(e,1),d.set({key:this.PHOTO_STORAGE,value:JSON.stringify(this.photos)});const o=t.filepath.substr(t.filepath.lastIndexOf("/")+1);yield b.deleteFile({path:o,directory:c.d.Data})}))}}return t.\u0275fac=function(e){return new(e||t)(l.Qb(i.J))},t.\u0275prov=l.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function p(t,e){if(1&t){const t=l.Nb();l.Mb(0,"ion-col",6),l.Mb(1,"ion-img",7),l.Ub("click",(function(){l.cc(t);const o=e.$implicit,i=e.index;return l.Wb().showActionSheet(o,i)})),l.Lb(),l.Lb()}if(2&t){const t=e.$implicit;l.zb(1),l.Zb("src",t.webviewPath)}}let f=(()=>{class t{constructor(t,e){this.photoService=t,this.actionSheetController=e}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.photoService.loadSaved()}))}showActionSheet(t,e){return Object(s.a)(this,void 0,void 0,(function*(){const o=yield this.actionSheetController.create({header:"Photos",buttons:[{text:"Delete",role:"destructive",icon:"trash",handler:()=>{this.photoService.deletePicture(t,e)}},{text:"Cancel",icon:"close",role:"cancel",handler:()=>{}}]});yield o.present()}))}}return t.\u0275fac=function(e){return new(e||t)(l.Jb(u),l.Jb(i.a))},t.\u0275cmp=l.Db({type:t,selectors:[["app-tab2"]],decls:15,vars:1,consts:[["collapse","condense"],["size","large"],["size","6",4,"ngFor","ngForOf"],["vertical","bottom","horizontal","center","slot","fixed"],[3,"click"],["name","camera"],["size","6"],[3,"src","click"]],template:function(t,e){1&t&&(l.Mb(0,"ion-header"),l.Mb(1,"ion-toolbar"),l.Mb(2,"ion-title"),l.gc(3," Photo Gallery "),l.Lb(),l.Lb(),l.Lb(),l.Mb(4,"ion-content"),l.Mb(5,"ion-header",0),l.Mb(6,"ion-toolbar"),l.Mb(7,"ion-title",1),l.gc(8,"Photo Gallery"),l.Lb(),l.Lb(),l.Lb(),l.Mb(9,"ion-grid"),l.Mb(10,"ion-row"),l.fc(11,p,2,1,"ion-col",2),l.Lb(),l.Lb(),l.Mb(12,"ion-fab",3),l.Mb(13,"ion-fab-button",4),l.Ub("click",(function(){return e.photoService.addNewToGallery()})),l.Kb(14,"ion-icon",5),l.Lb(),l.Lb(),l.Lb()),2&t&&(l.zb(11),l.Zb("ngForOf",e.photoService.photos))},directives:[i.p,i.G,i.F,i.k,i.o,i.x,r.h,i.l,i.m,i.q,i.j,i.r],styles:["ion-content[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background:translucent}"]}),t})();var v=o("HGan");let y=(()=>{class t{}return t.\u0275mod=l.Hb({type:t}),t.\u0275inj=l.Gb({factory:function(e){return new(e||t)},imports:[[i.H,r.b,a.a,v.a,n.k.forChild([{path:"",component:f}])]]}),t})()}}]);